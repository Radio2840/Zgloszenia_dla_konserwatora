{% extends 'base.html' %}

{% block content %}
  <h2 class="text-center p-2">Strona główna</h2>
    <div class="table table-dark">
        <div id="to_do" class="column">
            <h2>Do zrobienia</h2>

            {% for report in not_done_reports %}
                <p class="report"><a href="../report?id={{ report.id }}" class=" waga{{report.importance_of_the_report}}"> {{ report.title }} </a></p>
            {% empty %}
                <p>Nie ma żadnych zgłoszeń</p>
            {% endfor %}

        </div>
        <div id="in_progress" class="column">
            <h2>W trakcie</h2>
        
            {% for report in in_progress_reports %}
                <p class="report"><a href="../report?id={{ report.id }}" class=" waga{{report.importance_of_the_report}}"> {{ report.title }} </a></p>
            {% empty %}
                <p>Nie ma żadnych zgłoszeń</p>
            {% endfor %}
        
        </div>
        <div id="done" class="column">
            <h2>Zakończone</h2>
            
            {% for report in done_reports %}
                <p class="report"><a href="../report?id={{ report.id }}" class=" waga{{report.importance_of_the_report}}"> {{ report.title }} </a></p>
            {% empty %}
                <p>Nie ma żadnych zgłoszeń</p>
            {% endfor %}
        
        </div>
    </div>
    <script>

        holding_element = null;
        $(".report").toArray().forEach(element => {
           element.addEventListener('mousedown', (function(element, ele){
                    if(holding_element == null){
                        holding_element = element.target;
                        console.log(holding_element)
                    }
                })
           )
        });


        document.addEventListener('mousemove', function(event) {
            if(holding_element == null) return;
            moveElement(holding_element, event.clientX, event.clientY)
            event.preventDefault();
        });

        document.addEventListener('mouseup', function(event) {
            console.log(0)
            if (event.button === 0) { 
                holding_element = null;
            }
            
        });

        function moveElement(element, x, y){
            element.style.width = element.offsetWidth + 'px'
            element.style.height = element.offsetHeight + 'px'
            element.style.position = "absolute";
            element.style.left = x - (element.offsetWidth / 2) + 'px';
            element.style.top = y - (element.offsetHeight / 2) + 'px';
        }

    </script>
    <style>
        .table{
            background-color: rgba(0, 0, 0, 0.2);
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
        }

        .table .column{
            width: 33.33%;
            text-align: center;
            display: flex;
            flex-direction: column;
            border-left: 1px rgba(0, 0, 0, 0.2) solid;
            border-right: 1px rgba(0, 0, 0, 0.2) solid;
            margin: 0;
        }
        
        .column p{
            cursor: move;
            cursor: grab;
            background-color: rgba(0, 0, 0, 0.1);
            padding: 2px;
            margin: 0px;
            margin-top: 7px;
            width: 100%;
        }
        .column a{background-color: transparent;}
        a.waga1{color: #67ca53}
        a.waga2{color: #caa453}
        a.waga3{color: #ca5353}

    </style>
{% endblock %}